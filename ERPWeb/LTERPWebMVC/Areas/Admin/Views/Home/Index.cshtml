@model LTERPWebMVC.Areas.Admin.Models.HomeModel
@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta charset="utf-8" />
    <title>ERP管理系统</title>
    <meta name="description" content="overview &amp; stats" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

    <!-- bootstrap & fontawesome -->
    <link rel="stylesheet" href="~/Content/assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/Content/assets/font-awesome/4.5.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="~/Content/assets/css/jquery-ui.min.css" />
    <!-- page specific plugin styles -->
    <!-- text fonts -->
    <link rel="stylesheet" href="~/Content/assets/css/fonts.googleapis.com.css" />

    <!-- ace styles -->
    <link rel="stylesheet" href="~/Content/assets/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="assets/css/ace-part2.min.css" class="ace-main-stylesheet" />
    <![endif]-->
    <link rel="stylesheet" href="~/Content/assets/css/ace-skins.min.css" />
    <link rel="stylesheet" href="~/Content/assets/css/ace-rtl.min.css" />
    <link href="~/Content/home.css" rel="stylesheet" />
    <!--[if lte IE 9]>
      <link rel="stylesheet" href="assets/css/ace-ie.min.css" />
    <![endif]-->
    <!-- inline styles related to this page -->
    <!-- ace settings handler -->
    <script src="~/Content/assets/js/ace-extra.min.js"></script>

    <!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->
    <!--[if lte IE 8]>
    <script src="assets/js/html5shiv.min.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->
</head>

<body class="no-skin">
    <div id="navbar" class="navbar navbar-default          ace-save-state">
        <div class="navbar-container ace-save-state" id="navbar-container">
            <button type="button" class="navbar-toggle menu-toggler pull-left" id="menu-toggler" data-target="#sidebar">
                <span class="sr-only">Toggle sidebar</span>

                <span class="icon-bar"></span>

                <span class="icon-bar"></span>

                <span class="icon-bar"></span>
            </button>

            <div class="navbar-header pull-left">
                <a href="javascript:void(0);" class="navbar-brand default-cursor" onfocus="this.blur();">
                    <small>
                        @*<img src="~/Images/djzn_logo.png" style="width:75px;height:20px;" />*@
                        <i class="fa fa-leaf"></i> 
                        ERP管理系统
                    </small>
                </a>
                @*<a href="~/App/wmsapp.apk" target="_blank" style="color: #fff;margin-left: 20px;line-height: 45px;font-size: 12px;font-weight: bold;text-decoration:underline;">[智能仓储App] http://192.168.9.80/app/wmsapp.apk</a>*@ 
            </div>

            <div class="navbar-buttons navbar-header pull-right" role="navigation">
                <ul class="nav ace-nav">
                    <li class="grey dropdown-modal" style="display:none;">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <i class="ace-icon fa fa-tasks"></i>
                            <span class="badge badge-grey">4</span>
                        </a>

                        <ul class="dropdown-menu-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close">
                            <li class="dropdown-header">
                                <i class="ace-icon fa fa-check"></i>
                                4 Tasks to complete
                            </li>

                            <li class="dropdown-content">
                                <ul class="dropdown-menu dropdown-navbar">
                                    <li>
                                        <a href="#">
                                            <div class="clearfix">
                                                <span class="pull-left">Software Update</span>
                                                <span class="pull-right">65%</span>
                                            </div>

                                            <div class="progress progress-mini">
                                                <div style="width:65%" class="progress-bar"></div>
                                            </div>
                                        </a>
                                    </li>

                                    <li>
                                        <a href="#">
                                            <div class="clearfix">
                                                <span class="pull-left">Hardware Upgrade</span>
                                                <span class="pull-right">35%</span>
                                            </div>

                                            <div class="progress progress-mini">
                                                <div style="width:35%" class="progress-bar progress-bar-danger"></div>
                                            </div>
                                        </a>
                                    </li>

                                    <li>
                                        <a href="#">
                                            <div class="clearfix">
                                                <span class="pull-left">Unit Testing</span>
                                                <span class="pull-right">15%</span>
                                            </div>

                                            <div class="progress progress-mini">
                                                <div style="width:15%" class="progress-bar progress-bar-warning"></div>
                                            </div>
                                        </a>
                                    </li>

                                    <li>
                                        <a href="#">
                                            <div class="clearfix">
                                                <span class="pull-left">Bug Fixes</span>
                                                <span class="pull-right">90%</span>
                                            </div>

                                            <div class="progress progress-mini progress-striped active">
                                                <div style="width:90%" class="progress-bar progress-bar-success"></div>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </li>

                            <li class="dropdown-footer">
                                <a href="#">
                                    See tasks with details
                                    <i class="ace-icon fa fa-arrow-right"></i>
                                </a>
                            </li>
                        </ul>
                    </li>

                    <li class="purple dropdown-modal" style="display:none;">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <i class="ace-icon fa fa-bell icon-animated-bell"></i>
                            <span class="badge badge-important">8</span>
                        </a>

                        <ul class="dropdown-menu-right dropdown-navbar navbar-pink dropdown-menu dropdown-caret dropdown-close">
                            <li class="dropdown-header">
                                <i class="ace-icon fa fa-exclamation-triangle"></i>
                                8 Notifications
                            </li>

                            <li class="dropdown-content">
                                <ul class="dropdown-menu dropdown-navbar navbar-pink">
                                    <li>
                                        <a href="#">
                                            <div class="clearfix">
                                                <span class="pull-left">
                                                    <i class="btn btn-xs no-hover btn-pink fa fa-comment"></i>
                                                    New Comments
                                                </span>
                                                <span class="pull-right badge badge-info">+12</span>
                                            </div>
                                        </a>
                                    </li>

                                    <li>
                                        <a href="#">
                                            <i class="btn btn-xs btn-primary fa fa-user"></i>
                                            Bob just signed up as an editor ...
                                        </a>
                                    </li>

                                    <li>
                                        <a href="#">
                                            <div class="clearfix">
                                                <span class="pull-left">
                                                    <i class="btn btn-xs no-hover btn-success fa fa-shopping-cart"></i>
                                                    New Orders
                                                </span>
                                                <span class="pull-right badge badge-success">+8</span>
                                            </div>
                                        </a>
                                    </li>

                                    <li>
                                        <a href="#">
                                            <div class="clearfix">
                                                <span class="pull-left">
                                                    <i class="btn btn-xs no-hover btn-info fa fa-twitter"></i>
                                                    Followers
                                                </span>
                                                <span class="pull-right badge badge-info">+11</span>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </li>

                            <li class="dropdown-footer">
                                <a href="#">
                                    See all notifications
                                    <i class="ace-icon fa fa-arrow-right"></i>
                                </a>
                            </li>
                        </ul>
                    </li>

                    <li class="green dropdown-modal" style="display:none;">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <i class="ace-icon fa fa-envelope icon-animated-vertical"></i>
                            <span class="badge badge-success">5</span>
                        </a>

                        <ul class="dropdown-menu-right dropdown-navbar dropdown-menu dropdown-caret dropdown-close">
                            <li class="dropdown-header">
                                <i class="ace-icon fa fa-envelope-o"></i>
                                5 Messages
                            </li>

                            <li class="dropdown-content">
                                <ul class="dropdown-menu dropdown-navbar">
                                    <li>
                                        <a href="#" class="clearfix">
                                            @*<img src="assets/images/avatars/avatar.png" class="msg-photo" alt="Alex's Avatar" />*@
                                            <span class="msg-body">
                                                <span class="msg-title">
                                                    <span class="blue">Alex:</span>
                                                    Ciao sociis natoque penatibus et auctor ...
                                                </span>

                                                <span class="msg-time">
                                                    <i class="ace-icon fa fa-clock-o"></i>
                                                    <span>a moment ago</span>
                                                </span>
                                            </span>
                                        </a>
                                    </li>

                                    <li>
                                        <a href="#" class="clearfix">
                                            @*<img src="assets/images/avatars/avatar3.png" class="msg-photo" alt="Susan's Avatar" />*@
                                            <span class="msg-body">
                                                <span class="msg-title">
                                                    <span class="blue">Susan:</span>
                                                    Vestibulum id ligula porta felis euismod ...
                                                </span>

                                                <span class="msg-time">
                                                    <i class="ace-icon fa fa-clock-o"></i>
                                                    <span>20 minutes ago</span>
                                                </span>
                                            </span>
                                        </a>
                                    </li>

                                    <li>
                                        <a href="#" class="clearfix">
                                            @*<img src="assets/images/avatars/avatar4.png" class="msg-photo" alt="Bob's Avatar" />*@
                                            <span class="msg-body">
                                                <span class="msg-title">
                                                    <span class="blue">Bob:</span>
                                                    Nullam quis risus eget urna mollis ornare ...
                                                </span>

                                                <span class="msg-time">
                                                    <i class="ace-icon fa fa-clock-o"></i>
                                                    <span>3:15 pm</span>
                                                </span>
                                            </span>
                                        </a>
                                    </li>

                                    <li>
                                        <a href="#" class="clearfix">
                                            @*<img src="assets/images/avatars/avatar2.png" class="msg-photo" alt="Kate's Avatar" />*@
                                            <span class="msg-body">
                                                <span class="msg-title">
                                                    <span class="blue">Kate:</span>
                                                    Ciao sociis natoque eget urna mollis ornare ...
                                                </span>

                                                <span class="msg-time">
                                                    <i class="ace-icon fa fa-clock-o"></i>
                                                    <span>1:33 pm</span>
                                                </span>
                                            </span>
                                        </a>
                                    </li>

                                    <li>
                                        <a href="#" class="clearfix">
                                            @*<img src="assets/images/avatars/avatar5.png" class="msg-photo" alt="Fred's Avatar" />*@
                                            <span class="msg-body">
                                                <span class="msg-title">
                                                    <span class="blue">Fred:</span>
                                                    Vestibulum id penatibus et auctor  ...
                                                </span>

                                                <span class="msg-time">
                                                    <i class="ace-icon fa fa-clock-o"></i>
                                                    <span>10:09 am</span>
                                                </span>
                                            </span>
                                        </a>
                                    </li>
                                </ul>
                            </li>

                            <li class="dropdown-footer">
                                <a href="inbox.html">
                                    See all messages
                                    <i class="ace-icon fa fa-arrow-right"></i>
                                </a>
                            </li>
                        </ul>
                    </li>

                    <li class="light-blue dropdown-modal">
                        <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                            <img class="nav-user-photo" src="~/Images/admin.png" alt="Jason's Photo" />
                            <span class="user-info">
                                <small>欢迎,</small>
                               @LTERPWebMVC.App_Start.AppCode.CurrentUser.UserName
                            </span>
                            <i class="ace-icon fa fa-caret-down"></i>
                        </a>

                        <ul class="user-menu dropdown-menu-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
                            @*<li>
                                    <a href="#">
                                        <i class="ace-icon fa fa-cog"></i>
                                        设置
                                    </a>
                                </li>*@
                            <li>
                                <a href="#" id="id-btn-dialog1">
                                    <i class="ace-icon fa fa-user"></i>
                                    修改密码
                                </a>
                            </li>

                            <li class="divider"></li>

                            <li>
                                <a href="@Url.Action("LoginOut","Login")">
                                    <i class="ace-icon fa fa-power-off"></i>
                                    退出登录
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div><!-- /.navbar-container -->
    </div>

    <div class="main-container ace-save-state" id="main-container">
        <script type="text/javascript">
            try { ace.settings.loadState('main-container') } catch (e) { }
        </script>

        <div id="sidebar" class="sidebar                  responsive                    ace-save-state">
            <script type="text/javascript">
                try { ace.settings.loadState('sidebar') } catch (e) { }
            </script>

            <div class="sidebar-shortcuts" id="sidebar-shortcuts">
                <div class="sidebar-shortcuts-large" id="sidebar-shortcuts-large">
                    <button class="btn btn-success">
                        <i class="ace-icon fa fa-signal"></i>
                    </button>

                    <button class="btn btn-info">
                        <i class="ace-icon fa fa-pencil"></i>
                    </button>

                    <button class="btn btn-warning">
                        <i class="ace-icon fa fa-users"></i>
                    </button>

                    <button class="btn btn-danger">
                        <i class="ace-icon fa fa-cogs"></i>
                    </button>
                </div>

                <div class="sidebar-shortcuts-mini" id="sidebar-shortcuts-mini">
                    <span class="btn btn-success"></span>

                    <span class="btn btn-info"></span>

                    <span class="btn btn-warning"></span>

                    <span class="btn btn-danger"></span>
                </div>
            </div><!-- /.sidebar-shortcuts -->

            @if (Model != null && Model.Menu != null)
            {
                <ul class="nav nav-list">
                    @{
                        int dataid = 0;
                    }
                    @foreach (var item in Model.Menu.ChildItem)
                    {
                        if (!item.ShowOnMenu || (!item.Checked && item.Code.ToLower() != "none"))
                        {//过滤不展示和无权限菜单
                            continue;
                        }
                        dataid++;
                        <li>
                            @if (item.ChildItem.Count > 0)
                            {
                                <a href="javascript:void(0);" class="dropdown-toggle">
                                    <i class="menu-icon fa @item.Class"></i>
                                    <span class="menu-text">@item.Name</span>
                                    <b class="arrow fa fa-angle-down"></b>
                                </a>
                                <b class="arrow"></b>
                                <ul class="submenu">
                                    @foreach (var subitem in item.ChildItem)
                                    {
                                        if (!subitem.ShowOnMenu)
                                        {
                                            continue;
                                        }
                                        dataid++;
                                        <li>
                                            <a href="javascript:void(0);"
                                               data-url="@Url.Action(subitem.Action,subitem.Controller, new { area =subitem.AreaName })" data-id="@dataid" data-text="@subitem.Name">
                                                @*<i class="menu-icon fa fa-caret-right"></i>*@
                                                @subitem.Name
                                            </a>
                                            <b class="arrow"></b>
                                        </li>

                                    }
                                </ul>
                            }
                            else
                            {
                                <a href="javascript:void(0);" data-url="@Url.Action(item.Action,item.Controller, new { area =item.AreaName })" data-id="@dataid" data-text="@item.Name">
                                    <i class="menu-icon fa @item.Class"></i>
                                    <span class="menu-text">@item.Name</span>
                                </a>
                                <b class="arrow"></b>
                            }
                        </li>
                    }
                </ul>
            }
            <div class="sidebar-toggle sidebar-collapse" id="sidebar-collapse">
                <i id="sidebar-toggle-icon" class="ace-icon fa fa-angle-double-left ace-save-state" data-icon1="ace-icon fa fa-angle-double-left" data-icon2="ace-icon fa fa-angle-double-right"></i>
            </div>
        </div>

        <div class="main-content">
            <div class="main-content-inner">
                @*<div class="breadcrumbs ace-save-state" id="breadcrumbs">
                    </div>*@
                <div class="page-content page-content2" style="position:relative;">
                    <div id="tabContainer" class="tabcontainer"></div>
                    <div class="loader" style="display:none;"></div>
                    @*<div class="ibox float-e-margins">
                            <div id="tabContainer"></div>
                        </div>*@
                </div>
                <!-- /.page-content -->
            </div>
        </div><!-- /.main-content -->

        <div class="footer">
            <div class="footer-inner">
                <div class="footer-content" style="text-align:left;padding:5px 0;line-height:unset;">
                    <div class="form-group form-border" id="wcsstatusview" style="line-height:unset;">
                    </div>
                </div>
            </div>
        </div>
        <a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
            <i class="ace-icon fa fa-angle-double-up icon-only bigger-110"></i>
        </a>
    </div>



    <div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-front ui-dialog-buttons ui-draggable ui-resizable"
         style="display: none;"
         tabindex="-1" role="dialog" aria-describedby="dialog-message" aria-labelledby="ui-id-32">
        <div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix ui-draggable-handle">
            <div id="ui-id-32" class="ui-dialog-title">
                <div class="widget-header widget-header-small">
                    <h4 class="smaller"><i class="ace-icon fa fa-check"></i>修改密码</h4>
                </div>
            </div>
            <button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-icon-only ui-dialog-titlebar-close"
                    role="button" title="Close">
                <span class="ui-button-icon-primary ui-icon ui-icon-closethick"></span>
                <span class="ui-button-text">Close</span>
            </button>
        </div>
        <div id="dialog-message" class="ui-dialog-content ui-widget-content">
            <form class="form-horizontal" role="form">
                <div class="form-group">
                    <label class="col-sm-3 control-label no-padding-right" for="form-field-1">登录名：</label>
                    <div class="col-sm-9" style="padding-top:8px;">
                        @*<input type="text" id="form-field-1" placeholder="Username" class="col-xs-10 col-sm-5">*@
                        管理员
                    </div>
                </div>
                <div class="space-4"></div>
                <div class="form-group">
                    <label class="col-sm-3 control-label no-padding-right" for="form-field-2">原密码：</label>
                    <div class="col-sm-9">
                        <input type="password" id="edit_pwdold" name="edit_pwdold" placeholder="请输入原密码" class="col-xs-10">
                    </div>
                </div>
                <div class="space-4"></div>
                <div class="form-group">
                    <label class="col-sm-3 control-label no-padding-right" for="form-field-2">新密码：</label>
                    <div class="col-sm-9">
                        <input type="password" id="edit_pwdnew" name="edit_pwdnew" placeholder="请输入新密码" class="col-xs-10">
                    </div>
                </div>
                <div class="space-4"></div>
                <div class="form-group">
                    <label class="col-sm-3 control-label no-padding-right" for="form-field-2">确认新密码：</label>
                    <div class="col-sm-9">
                        <input type="password" id="edit_pwdnew2" name="edit_pwdnew2" placeholder="请输入确认新密码" class="col-xs-10">
                    </div>
                </div>
            </form>

        </div><div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div>
        <div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div>
        <div class="ui-resizable-handle ui-resizable-s" style="z-index: 90;"></div>
        <div class="ui-resizable-handle ui-resizable-w" style="z-index: 90;"></div>
        <div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90;"></div>
        <div class="ui-resizable-handle ui-resizable-sw" style="z-index: 90;"></div>
        <div class="ui-resizable-handle ui-resizable-ne" style="z-index: 90;"></div>
        <div class="ui-resizable-handle ui-resizable-nw" style="z-index: 90;"></div>
        <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
            <div class="ui-dialog-buttonset">
                <button type="button" class="btn btn-minier ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button">
                    <span class="ui-button-text">Cancel</span>
                </button>
                <button type="button" class="btn btn-primary btn-minier ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button">
                    <span class="ui-button-text">OK</span>
                </button>
            </div>
        </div>
    </div>


    <script src="~/Content/assets/js/jquery-2.1.4.min.js"></script>
    <script src="~/Scripts/open-tabs.js"></script>
    <script src="~/Content/assets/js/bootstrap.min.js"></script>
    <!-- page specific plugin scripts -->
    <script src="~/Content/assets/js/jquery-ui.min.js"></script>
    <script src="~/Content/assets/js/jquery.ui.touch-punch.min.js"></script>

    <script src="~/Content/assets/js/ace-elements.min.js"></script>
    <script src="~/Content/assets/js/ace.min.js"></script>
    <!-- inline scripts related to this page -->
    <script type="text/javascript">
        jQuery(function ($) {
            var iframe;
            //初始化第一个菜单
            $(".nav-list a").each(function (i, ele) {
                if ($(ele).attr("data-url")) {
                    iframe = $("#tabContainer").iframes({
                        data: [{
                            id: $(ele).attr("data-id"),
                            text: $(ele).attr("data-text"),
                            url: $(ele).attr("data-url"),
                            closeable: false
                        }],
                        //showIndex: 1,
                        loadAll: false
                    });
                    return;
                }
            });
            //绑定菜单点击事件
            $(".nav-list a").each(function (i, ele) {
                if ($(ele).attr("data-url")) {
                    $(ele).click(function () {
                        iframe.addIframe({
                            id: $(this).attr("data-id"),
                            text: $(this).attr("data-text"),
                            url: $(this).attr("data-url")
                            , closeable: true
                        });
                    });
                }
            })

            //修改密码
            $("#id-btn-dialog1").on('click', function (e) {
                e.preventDefault();
                var dialog = $("#dialog-message").removeClass('hide').dialog({
                    modal: true,
                    width: 400,
                    title: "<div class='widget-header widget-header-small'><h4 class='smaller'><i class='ace-icon fa fa-group'></i> 修改密码</h4></div>",
                    buttons: [
                        {
                            text: "取消",
                            "class": "btn btn-minier",
                            click: function () {
                                $(this).dialog("close");
                            }
                        },
                        {
                            text: "修改密码",
                            "class": "btn btn-primary btn-minier",
                            click: function () {
                                var _updateurl = "@Url.Action("UpdateUserPwd", "Login")";
                                var _oldpwd = $("#edit_pwdold").val();
                                var _newpwd = $("#edit_pwdnew").val();
                                var _newpwd2 = $("#edit_pwdnew2").val();

                                if (_oldpwd == "" || _newpwd == "" || _newpwd2 == "") {
                                    alert("密码不能为空！");
                                    return;
                                }
                                var upBtn = $(this);
                                $.post(_updateurl, { old: _oldpwd, new1: _newpwd, new2: _newpwd2 }, function (result) {
                                    if (result.success) {
                                        alert("修改成功！");
                                        //清空数据
                                        $("#edit_pwdold").val("");
                                        $("#edit_pwdnew").val("");
                                        $("#edit_pwdnew2").val("");
                                        upBtn.dialog("close");
                                    } else {
                                        alert(result.errors);
                                    }
                                });

                            }
                        }
                    ]
                });
            });
        });
    </script>

</body>
</html>
